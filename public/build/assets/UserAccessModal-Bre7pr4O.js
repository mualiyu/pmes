import{f as _,h as F,i as R,k as M,j as s,B as P,E,a as h,aL as S,r as c,H as U,b as B}from"./app-CQeDVQuS.js";import{u as C}from"./useForm-p-9YiRut.js";import{h as f}from"./user-IyQLa11_.js";import{T as N}from"./Text-C7Ogcti-.js";import{M as g}from"./MultiSelect-BTwgAEuD.js";import{F as q}from"./Flex-BgjLIV7l.js";import"./index-CdE3aVqV.js";import"./use-resolved-styles-api-BXRJnP4G.js";import"./OptionsDropdown-D2SabLis.js";import"./CheckIcon-D3YounCa.js";import"./Combobox-CG5rkmIX.js";import"./Popover-CRA-5r7S.js";import"./use-floating-auto-update-DtQKRGxQ.js";import"./noop-BjFrJKj1.js";import"./use-uncontrolled-DDoK6Wjp.js";import"./Input-BpqpINKS.js";import"./InputBase-BmeHhBbi.js";import"./Pill-tisBWBts.js";import"./PillsInput-BdX_zTjY.js";var j={root:"m_18320242","skeleton-fade":"m_299c329c"};const A={visible:!0,animate:!0},T=M((t,{width:r,height:a,radius:l,circle:i})=>({root:{"--skeleton-height":h(a),"--skeleton-width":i?h(a):h(r),"--skeleton-radius":i?"1000px":l===void 0?void 0:E(l)}})),n=_((t,r)=>{const a=F("Skeleton",A,t),{classNames:l,className:i,style:d,styles:m,unstyled:o,vars:u,width:p,height:x,circle:e,visible:v,radius:z,animate:b,mod:k,...y}=a,w=R({name:"Skeleton",classes:j,props:a,className:i,style:d,classNames:l,styles:m,unstyled:o,vars:u,varsResolver:T});return s.jsx(P,{ref:r,...w("root"),mod:[{visible:v,animate:b},k],...y})});n.classes=j;n.displayName="@mantine/core/Skeleton";function V({item:t}){const[r,a]=c.useState(!0),[l,i]=c.useState([]),[d,m]=c.useState([]),[o,u,p]=C("post",route("projects.user_access",t.id),{users:t.users_with_access.filter(e=>!f(e,["system administrator","stakeholder"])).map(e=>e.id.toString()),clients:t.users_with_access.filter(e=>f(e,["stakeholder"])&&e.reason!=="company owner").map(e=>e.id.toString())}),x=e=>{u(e,{onSuccess:()=>S.closeAll(),preserveScroll:!0})};return c.useEffect(()=>{U.get(route("dropdown.values",["users","clients"])).then(({data:e})=>{i([...e.users]),m([...e.clients])}).catch(()=>alert("Something went wrong, failed to load dropdown values")).finally(()=>a(!1))},[o.data]),s.jsxs("form",{onSubmit:x,children:[r?s.jsxs(s.Fragment,{children:[s.jsx(n,{height:10,width:50,mt:8,radius:"xl"}),s.jsx(n,{height:25,mt:10,radius:"xl"}),s.jsx(n,{height:10,width:50,mt:25,radius:"xl"}),s.jsx(n,{height:25,mt:10,radius:"xl"})]}):s.jsxs(s.Fragment,{children:[s.jsx(g,{label:"Users",placeholder:"Select users",searchable:!0,value:r?[]:o.data.users,onChange:e=>p("users",e),data:l,error:o.errors.users}),s.jsx(g,{label:"Stakeholders",placeholder:"Select stakeholders",searchable:!0,mt:"md",value:r?[]:o.data.clients,onChange:e=>p("clients",e),data:d,error:o.errors.clients})]}),s.jsx(q,{justify:"flex-end",mt:"xl",children:s.jsx(B,{type:"submit",w:100,disabled:r,loading:o.processing,children:"Save"})})]})}const ae=t=>{S.open({title:s.jsx(N,{size:"xl",fw:700,mb:-10,children:"User access"}),centered:!0,padding:"xl",overlayProps:{backgroundOpacity:.55,blur:3},children:s.jsx(V,{item:t})})};export{ae as default};
